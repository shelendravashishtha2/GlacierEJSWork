<%- contentFor('HeaderCss') %>
<link href="<%=process.env.PUBLIC_URL%>/public/assets/libs/select2/css/select2.min.css" rel="stylesheet" type="text/css" />
<link href="<%=process.env.PUBLIC_URL%>/public/assets/libs/bootstrap-datepicker/css/bootstrap-datepicker.min.css" rel="stylesheet" type="text/css">
<link href="<%=process.env.PUBLIC_URL%>/public/assets/libs/spectrum-colorpicker2/spectrum.min.css" rel="stylesheet" type="text/css">
<link href="<%=process.env.PUBLIC_URL%>/public/assets/libs/bootstrap-timepicker/css/bootstrap-timepicker.min.css" rel="stylesheet" type="text/css">
<link href="<%=process.env.PUBLIC_URL%>/public/assets/libs/bootstrap-touchspin/jquery.bootstrap-touchspin.min.css" rel="stylesheet" type="text/css" />
<link rel="stylesheet" href="<%=process.env.PUBLIC_URL%>/public/assets/libs/@chenfengyuan/datepicker/datepicker.min.css">
<style type="text/css">
.image_container {
    height: 120px;
    width: 200px;
    border-radius: 6px;
    overflow: hidden;
    margin: 10px;
}
.image_container img {
    height: 100%;
    width: 100%;
    /* object-fit: cover; */
}
.image_container span {
    top: -6px;
    right: 8px;
    color: red;
    font-size: 28px;
    font-weight: normal;
    cursor: pointer;
}
</style>
<%- contentFor('breadcrumb') %>
<!-- start page title -->
<div class="row">
    <div class="col-12">
        <div class="page-title-box d-sm-flex align-items-center justify-content-between">
            <h4 class="mb-sm-0 font-size-18">Add SOP</h4>
            <div class="page-title-right">
                <ol class="breadcrumb m-0">
                    <li class="breadcrumb-item"><a href="/sop">SOP</a></li>
                    <li class="breadcrumb-item active">Add SOP</li>
                </ol>
            </div>
        </div>
    </div>
</div>
<!-- end page title -->
<%- contentFor('body') %>
<div class="row">
    <div class="col-xl-12">
        <div class="card">
            <div class="card-body">
                <h4 class="card-title">Add SOP</h4>
                <form action="/store-sop" method="POST" enctype="multipart/form-data" class="custom-validation">
                    <div class="row">
                        <div class="col-xl-6">
                            <div class="mb-3">
                                <label class="form-label">Category Name<span class="required">*</span></label>
                                <input type="text" name="category_name" class="form-control" id="defaultconfig" placeholder="Enter Category Name" autofocus maxlength="200" required>
                            </div>
                            <div class="mb-3">
                                <label class="form-label">Level</label>
                                <select class="form-control" name="category_level" id="category_level" required>
                                    <option value="1">Level 1</option>
                                    <option value="2">Level 2</option>
                                </select>
                            </div>
                            <div class="mb-3" id="single_pdf_input">
                                <label class="form-label">Upload PDF</label>
                                <input type="file" name="single_category_files" multiple="" class="form-control" required>
                            </div>
                            <div class="card" id="sub_category">
                                <div class="card-body">
                                    <h4 class="card-title">Add Sub Category 
										<a href="javascript:void(0);" class="add_button btn btn-warning" style="float: right;" title="Add Sub Category">Add More</a>
									</h4>
                                    <div class="mb-3 row">
										<div class="col-md-5 col-5">
											<input type="text" name="sub_category_name[0]" class="form-control" id="defaultconfig" placeholder="Enter Sub Category Name" autofocus maxlength="200" required>
										</div>
										<div class="col-md-5 col-5">
											<input type="file" name="sub_category_files[0]" multiple="" class="form-control" required>
										</div>
                                    </div>
									<div class="input_field_wrapper"></div>
									<input type="hidden" name="sub_category_count" id="sub_category_count" value="1" required>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="row" style="margin-bottom:20px;">
                        <div class="col-xl-2"></div>
                        <div class="col-xl-6">
                            <button type="submit" class="btn btn-warning waves-effect waves-light"><i class="bx bx-check-double label-icon"></i> Save</button>
                            <a href="/sop"><button type="button" class="btn btn-danger waves-effect waves-light"><i class="bx bx-block label-icon"></i> Cancel</button></a>
                        </div>  
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>
<!-- end row -->
<%- contentFor('FooterJs') %>
<script src="<%=process.env.PUBLIC_URL%>/public/assets/libs/parsleyjs/parsley.min.js"></script>
<script src="<%=process.env.PUBLIC_URL%>/public/assets/js/pages/form-validation.init.js"></script>

<script type="text/javascript">
    $(document).ready(function(){
        var maxFieldLimit = 30; //Input fields increment limitation
        var add_more_button = $('.add_button'); //Add button selector
        var Fieldwrapper = $('.input_field_wrapper'); //Input field wrapper
        // var fieldHTML = '<div style="display:flex;margin:5px;"><div class="col-md-5 col-5"> <input type="text" name="sub_category_name[0]" class="form-control" id="defaultconfig" placeholder="Enter Category Name" autofocus maxlength="200"> </div> <div class="col-md-5 col-5"> <input type="file" name="sub_category_files[0]" multiple="" class="form-control"> </div><a href="javascript:void(0);" class="remove_button btn btn-danger" style="margin-left:10px;">-</a></div>'; //New input field html 
        var x = 1; //Initial field counter is 1
        $(add_more_button).click(function(){ //Once add button is clicked
            if(x < maxFieldLimit){ //Check maximum number of input fields
				var fieldHTML = '<div style="display:flex;margin:5px;"><div class="col-md-5 col-5"> <input type="text" name="sub_category_name['+x+']" class="form-control" id="defaultconfig" placeholder="Enter Category Name" autofocus maxlength="200"> </div> <div class="col-md-5 col-5"> <input type="file" name="sub_category_files['+x+']" multiple="" class="form-control"> </div><a href="javascript:void(0);" class="remove_button btn btn-danger" style="margin-left:10px;">-</a></div>';
                $(Fieldwrapper).append(fieldHTML); // Add field html
				x++; //Increment field counter
				$('#sub_category_count').val(x);
            }
        });
        $(Fieldwrapper).on('click', '.remove_button', function(e){ //Once remove button is clicked
            e.preventDefault();
            $(this).parent('div').remove(); //Remove field html
            x--; //Decrement field counter
			$('#sub_category_count').val(x);
        });
    });

	// on select level hide/show sub category
	$(function() {
		$('#sub_category').hide();
		$('#category_level').change(function(){
			if($('#category_level').val() == 1) {
				$('#single_pdf_input').show();
				$('#sub_category').hide();
			} else if($('#category_level').val() == 2) {
				$('#sub_category').show();
				$('#single_pdf_input').hide();
			} 
		});
	});

</script>
<%- contentFor('BottomJs') %>